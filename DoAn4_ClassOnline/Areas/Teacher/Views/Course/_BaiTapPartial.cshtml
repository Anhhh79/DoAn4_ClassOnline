
<style>
    .student-list-container {
        max-height: 260px;
        overflow-y: auto;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        background: #fff;
    }

    .student-header {
        position: sticky;
        top: 0;
        background: #fff;
        z-index: 10;
        padding: 10px 12px;
        border-bottom: 1px solid #f1f3f5;
    }

    .student-item {
        cursor: pointer;
        transition: 0.15s;
        border-radius: 8px;
    }

        .student-item:hover {
            background: #f5f7fa;
        }
</style>

<div class="row g-3 mt-4 p-3 shadow rounded-4 bg-white">

    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-bold mb-0">
            <i class="bi bi-journal-check me-2 text-primary"></i> Bài tập
        </h5>
        <button type="button" class="btn btn-success btn-sm text-light" data-bs-toggle="modal" data-bs-target="#addBaiTapModal" onclick="initTaoBaiTapModal(), resetFormTaoBaiTap()">
            <i class="bi bi-plus-lg me-1"></i> Tạo bài tập
        </button>
    </div>

    <!-- Modal thêm bài tập -->
    <div class="modal fade" id="addBaiTapModal" tabindex="-1" aria-labelledby="addBaiTapModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <form id="formAddBaiTap" method="post" enctype="multipart/form-data" class="needs-validation" novalidate>
                    <div class="modal-header">
                        <h5 class="modal-title fw-bold" id="addBaiTapModalLabel">
                            <i class="bi bi-journal-plus me-2 text-primary"></i> Tạo bài tập
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body mb-2">
                        <div class="row g-3 px-3">

                            <!-- Tiêu đề -->
                            <div class="col-12">
                                <label class="form-label">Tiêu đề bài tập</label>
                                <input type="text" class="form-control" name="TieuDe" id="TieuDe_AddBaiTap"
                                       maxlength="200" required>
                                <div class="invalid-feedback">Vui lòng nhập tiêu đề!</div>
                            </div>

                            <!-- Mô tả -->
                            <div class="col-12">
                                <label class="form-label">Mô tả</label>
                                <textarea class="form-control" name="MoTa" id="MoTa_AddBaiTap" rows="4" required></textarea>
                                <div class="invalid-feedback">Vui lòng nhập mô tả!</div>
                            </div>

                            <!-- Thời gian -->
                            <div class="col-md-6">
                                <label class="form-label">Thời gian bắt đầu</label>
                                <div class="input-group">
                                    <input type="datetime-local" name="ThoiGianBatDau" id="startPicker_AddBaiTap" class="form-control">
                                    <span class="input-group-text"><i class="bi bi-calendar-event"></i></span>
                                </div>
                                <div class="invalid-feedback">Thời gian không hợp lệ!</div>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Thời gian kết thúc</label>
                                <div class="input-group">
                                    <input type="datetime-local" name="ThoiGianKetThuc" id="ThoiGianKetThuc_AddBaiTap" class="form-control">
                                    <span class="input-group-text"><i class="bi bi-calendar-event"></i></span>
                                </div>
                                <div class="invalid-feedback">Thời gian không hợp lệ!</div>
                            </div>

                            <!-- File -->
                            <div class="col-12">
                                <label class="form-label">File đính kèm (tùy chọn)</label>
                                <input type="file" id="inputFile_Add" class="form-control" name="files" multiple>
                            </div>

                            <!-- Giao cho -->
                            <div class="col-12 mt-3">
                                <label class="form-label d-flex justify-content-between align-items-center mb-2">
                                    <span>Giao cho</span>
                                </label>

                                <div class="student-list-container">

                                    <!-- Header -->
                                    <div class="student-header">
                                        <div class="d-flex justify-content-between align-items-center my-2">

                                            <!-- Search -->
                                            <div class="input-group w-50">
                                                <span class="input-group-text"><i class="bi bi-search"></i></span>
                                                <input type="search" class="form-control form-control-sm"
                                                       id="searchSinhVien_Giao"
                                                       placeholder="Tìm theo tên học sinh...">
                                            </div>

                                            <!-- Check all -->
                                            <div class="form-check ms-2">
                                                <input class="form-check-input" type="checkbox" id="checkAllStudentsStatic">
                                                <label class="form-check-label small" for="checkAllStudentsStatic">
                                                    Chọn tất cả
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Danh sách -->
                                    <div class="p-2" id="danhSachSinhVien_Giao"></div>

                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Hủy</button>
                        <button type="button" id="btnLuuBaiTap" class="btn btn-primary text-light" onclick="taoBaiTap()">
                            <i class="bi bi-save me-1"></i> Lưu bài tập
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>


    <div id="container_BaiTapList">

    </div>

    <!-- Modal sửa bài tập -->
    <div class="modal fade" id="editBaiTapModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <form enctype="multipart/form-data" class="needs-validation" novalidate>

                    <input type="hidden" id="editKhoaHocId" name="KhoaHocId">

                    <div class="modal-header">
                        <h5 class="modal-title fw-bold">
                            <i class="bi bi-pencil-square me-2 text-primary"></i> Sửa bài tập
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>

                    <div class="modal-body mb-2">
                        <div class="row g-3 px-3">

                            <input type="hidden" id="editBaiTapId" name="Id">

                            <div class="col-12">
                                <label class="form-label">Tiêu đề bài tập</label>
                                <input type="text" id="editTieuDe" name="TieuDe" class="form-control" required>
                            </div>

                            <div class="col-12">
                                <label class="form-label">Mô tả</label>
                                <textarea id="editMoTa" name="MoTa" class="form-control" rows="4" required></textarea>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Thời gian bắt đầu</label>
                                <input type="datetime-local" id="editThoiGianBatDau" name="ThoiGianBatDau" class="form-control" required>
                            </div>

                            <div class="col-md-6">
                                <label class="form-label">Thời gian kết thúc</label>
                                <input type="datetime-local" id="editThoiGianKetThuc" name="ThoiGianKetThuc" class="form-control" required>
                            </div>

                            <!-- File hiện tại (JS render 100%) -->
                            <div class="col-12">
                                <label class="form-label text-muted">File hiện tại:</label>
                                <div id="currentFilesBaiTap" class="border rounded-3 p-2 bg-light small">
                                    <!-- JS render -->
                                </div>
                            </div>

                            <div class="col-12">
                                <label class="form-label mt-2">Thêm file mới (tùy chọn)</label>
                                <input type="file" id="editFiles" name="Files" class="form-control" multiple>
                            </div>

                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Hủy</button>

                        <button type="button" class="btn btn-primary text-light" onclick="capNhatBaiTap()">
                            <i class="bi bi-save me-1"></i> Cập nhật
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>


</div>



